<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>3</title>
  <link rel="stylesheet" href="css/style.css">
  <script type="text/javascript" src="vendor/createjs/createjs.min.js"></script>
  <script type="text/javascript" src="js/monster.js"></script>
  <script type="text/javascript" src="js/knight.js"></script>
  <script type="text/javascript" src="js/inventory.js"></script>
  <script type="text/javascript" src="js/abilityPanel.js"></script>
  <script type="text/javascript" src="js/equipmentPanel.js"></script>
  <script type="text/javascript" src="js/script.js"></script>
</head>

<body onload="init()">
  <canvas id="demoCanvas" width="2000" height="1000"></canvas>
  <script>
  var game;
  function init() {
    game = new Game("demoCanvas");
    game.start();
    if (!game.storage.getField("coins")) {
      game.storage.setField("coins", 0);
      alert(game.storage.getField("coins"));
    };
    game.stage.on("stagemousedown", function(event) {
      //console.log(event);
      if (!event.relatedTarget) {
        game.knight.walk(event.stageX - 42.5, event.stageY - 42.5);
      };
    });
    document.onkeydown = function(ev) {
      console.log(ev);
      console.log(ev.code);
      if (ev.code == 'KeyB') {
        game.inventory.toggle();
      };
      if (ev.code == 'Enter') {
        
        if (levels[game.storage.getField("level") + 1].XP <= game.storage.getField("levelPoints") & levels[game.storage.getField("level") + 1].coins <= game.storage.getField("coins")) {
          alert()
          game.storage.refresh("coins", game.storage.getField("coins"), - levels[game.storage.getField("level") + 1].coins)
          game.storage.refresh("level", game.storage.getField("level"), 1);
          game.equipmentPanel.refresh();
          game.inventory.refresh();
        }
      }
      if (ev.code == 'KeyC') {
        game.equipmentPanel.toggle();
      }
      if (ev.code == 'KeyA') {
        game.knight.useAbility('slam');
      };
      if (ev.code == 'KeyS') {
        game.knight.useAbility('heal');
      };
      if (ev.code.substring(0, 5) == 'Digit') {
        game.inventory.applySlot(parseInt(ev.code.substring(5)));
      }
    };
    game.resizeCanvas();
    window.addEventListener("resize",function(){
        console.log('check');
       game.resizeCanvas();
    });
  }
  </script>
</body>

</html>